// Copyright (c) 2024 Karl Gaissmaier
// SPDX-License-Identifier: MIT

package bart

import "cmp"

// Please read the ART paper ./doc/artlookup.pdf
// to understand the baseIndex algorithm.

// netMask as lookup table
var netMask = [9]uint8{
	0b0000_0000, // bits == 0
	0b1000_0000, // bits == 1
	0b1100_0000, // bits == 2
	0b1110_0000, // bits == 3
	0b1111_0000, // bits == 4
	0b1111_1000, // bits == 5
	0b1111_1100, // bits == 6
	0b1111_1110, // bits == 7
	0b1111_1111, // bits == 8
}

const (

	// baseIndex of the first host route: prefixToBaseIndex(0,8)
	firstHostIndex = 0b1_0000_0000 // 256

	// baseIndex of the last host route: prefixToBaseIndex(255,8)
	//nolint:unused
	lastHostIndex = 0b1_1111_1111 // 511
)

// prefixToBaseIndex, maps a prefix table as a 'complete binary tree'.
// This is the so-called baseIndex a.k.a heapFunc:
func prefixToBaseIndex(octet byte, prefixLen int) uint {
	return uint(octet>>(strideLen-prefixLen)) + (1 << prefixLen)
}

// baseIndexToPrefixLen, calc the bits from baseIndex and octect depth
func baseIndexToPrefixLen(baseIdx uint, depth int) int {
	_, pfxLen := baseIndexToPrefix(baseIdx)
	return depth*strideLen + pfxLen
}

// octetToBaseIndex, just prefixToBaseIndex(octet, 8), a.k.a host routes
// but faster, use it for host routes in Lookup.
func octetToBaseIndex(octet byte) uint {
	return uint(octet) + firstHostIndex // just: octet + 256
}

// hostRouteByAddr, get the host routes for child addrs.
//
//	addr:   72
//	route:  72 + 256 = 328
func hostRouteByAddr(addr uint) uint {
	return octetToBaseIndex(byte(addr))
}

// hostRoutesByIndex, get range of host routes for this idx.
//
//	idx:    72
//	prefix: 32/6
//	lower:  256 + 32 = 288
//	upper:  256 + (32 | 0b0000_0011) = 291
//
// Use the pre computed lookup table.
//
//	 func hostRoutesByIndex(idx uint) (uint, uint) {
//		 octet, bits := baseIndexToPrefix(idx)
//		 return octetToBaseIndex(octet), octetToBaseIndex(octet | ^netMask[bits])
//	 }
func hostRoutesByIndex(idx uint) (uint, uint) {
	item := baseIdxLookupTbl[idx]
	return uint(item.lower), uint(item.upper)
}

// baseIndexToPrefix returns the octet and prefix len of baseIdx.
// It's the inverse to prefixToBaseIndex.
//
// Use the pre computed lookup table, bits.LeadingZeros is too slow.
//
//	func baseIndexToPrefix(baseIdx uint) (octet byte, pfxLen int) {
//		nlz := bits.LeadingZeros(baseIdx)
//		pfxLen = strconv.IntSize - nlz - 1
//		octet = (baseIdx & (0xFF >> (8 - pfxLen))) << (8 - pfxLen)
//		return octet, pfxLen
//	}
func baseIndexToPrefix(baseIdx uint) (octet byte, pfxLen int) {
	item := baseIdxLookupTbl[baseIdx]
	return item.octet, int(item.bits)
}

// cmpIndexRank, compare SortFunc to sort indexes in prefix sort order.
func cmpIndexRank(a, b uint) int {
	return cmp.Compare(baseIdxLookupTbl[a].rank, baseIdxLookupTbl[b].rank)
}

// baseIdxLookupTbl
//
//	octet, bits,
//	host route boundaries,
//	prefix sort rank
//
// as lookup table.
//
// All values are written as decimals, so no hassle with different byte order for little- or big-endian.
var baseIdxLookupTbl = [512]struct {
	octet byte
	bits  int8
	lower uint16 // host route lower bound
	upper uint16 // host route upper bound
	rank  uint16 // prefix sort rank
}{
	/* idx == 0   */ {0, -1, 0, 0, 0}, // invalid!
	/* idx == 1   */ {0, 0, 256, 511, 1},
	/* idx == 2   */ {0, 1, 256, 383, 2},
	/* idx == 3   */ {128, 1, 384, 511, 257},
	/* idx == 4   */ {0, 2, 256, 319, 3},
	/* idx == 5   */ {64, 2, 320, 383, 130},
	/* idx == 6   */ {128, 2, 384, 447, 258},
	/* idx == 7   */ {192, 2, 448, 511, 385},
	/* idx == 8   */ {0, 3, 256, 287, 4},
	/* idx == 9   */ {32, 3, 288, 319, 67},
	/* idx == 10  */ {64, 3, 320, 351, 131},
	/* idx == 11  */ {96, 3, 352, 383, 194},
	/* idx == 12  */ {128, 3, 384, 415, 259},
	/* idx == 13  */ {160, 3, 416, 447, 322},
	/* idx == 14  */ {192, 3, 448, 479, 386},
	/* idx == 15  */ {224, 3, 480, 511, 449},
	/* idx == 16  */ {0, 4, 256, 271, 5},
	/* idx == 17  */ {16, 4, 272, 287, 36},
	/* idx == 18  */ {32, 4, 288, 303, 68},
	/* idx == 19  */ {48, 4, 304, 319, 99},
	/* idx == 20  */ {64, 4, 320, 335, 132},
	/* idx == 21  */ {80, 4, 336, 351, 163},
	/* idx == 22  */ {96, 4, 352, 367, 195},
	/* idx == 23  */ {112, 4, 368, 383, 226},
	/* idx == 24  */ {128, 4, 384, 399, 260},
	/* idx == 25  */ {144, 4, 400, 415, 291},
	/* idx == 26  */ {160, 4, 416, 431, 323},
	/* idx == 27  */ {176, 4, 432, 447, 354},
	/* idx == 28  */ {192, 4, 448, 463, 387},
	/* idx == 29  */ {208, 4, 464, 479, 418},
	/* idx == 30  */ {224, 4, 480, 495, 450},
	/* idx == 31  */ {240, 4, 496, 511, 481},
	/* idx == 32  */ {0, 5, 256, 263, 6},
	/* idx == 33  */ {8, 5, 264, 271, 21},
	/* idx == 34  */ {16, 5, 272, 279, 37},
	/* idx == 35  */ {24, 5, 280, 287, 52},
	/* idx == 36  */ {32, 5, 288, 295, 69},
	/* idx == 37  */ {40, 5, 296, 303, 84},
	/* idx == 38  */ {48, 5, 304, 311, 100},
	/* idx == 39  */ {56, 5, 312, 319, 115},
	/* idx == 40  */ {64, 5, 320, 327, 133},
	/* idx == 41  */ {72, 5, 328, 335, 148},
	/* idx == 42  */ {80, 5, 336, 343, 164},
	/* idx == 43  */ {88, 5, 344, 351, 179},
	/* idx == 44  */ {96, 5, 352, 359, 196},
	/* idx == 45  */ {104, 5, 360, 367, 211},
	/* idx == 46  */ {112, 5, 368, 375, 227},
	/* idx == 47  */ {120, 5, 376, 383, 242},
	/* idx == 48  */ {128, 5, 384, 391, 261},
	/* idx == 49  */ {136, 5, 392, 399, 276},
	/* idx == 50  */ {144, 5, 400, 407, 292},
	/* idx == 51  */ {152, 5, 408, 415, 307},
	/* idx == 52  */ {160, 5, 416, 423, 324},
	/* idx == 53  */ {168, 5, 424, 431, 339},
	/* idx == 54  */ {176, 5, 432, 439, 355},
	/* idx == 55  */ {184, 5, 440, 447, 370},
	/* idx == 56  */ {192, 5, 448, 455, 388},
	/* idx == 57  */ {200, 5, 456, 463, 403},
	/* idx == 58  */ {208, 5, 464, 471, 419},
	/* idx == 59  */ {216, 5, 472, 479, 434},
	/* idx == 60  */ {224, 5, 480, 487, 451},
	/* idx == 61  */ {232, 5, 488, 495, 466},
	/* idx == 62  */ {240, 5, 496, 503, 482},
	/* idx == 63  */ {248, 5, 504, 511, 497},
	/* idx == 64  */ {0, 6, 256, 259, 7},
	/* idx == 65  */ {4, 6, 260, 263, 14},
	/* idx == 66  */ {8, 6, 264, 267, 22},
	/* idx == 67  */ {12, 6, 268, 271, 29},
	/* idx == 68  */ {16, 6, 272, 275, 38},
	/* idx == 69  */ {20, 6, 276, 279, 45},
	/* idx == 70  */ {24, 6, 280, 283, 53},
	/* idx == 71  */ {28, 6, 284, 287, 60},
	/* idx == 72  */ {32, 6, 288, 291, 70},
	/* idx == 73  */ {36, 6, 292, 295, 77},
	/* idx == 74  */ {40, 6, 296, 299, 85},
	/* idx == 75  */ {44, 6, 300, 303, 92},
	/* idx == 76  */ {48, 6, 304, 307, 101},
	/* idx == 77  */ {52, 6, 308, 311, 108},
	/* idx == 78  */ {56, 6, 312, 315, 116},
	/* idx == 79  */ {60, 6, 316, 319, 123},
	/* idx == 80  */ {64, 6, 320, 323, 134},
	/* idx == 81  */ {68, 6, 324, 327, 141},
	/* idx == 82  */ {72, 6, 328, 331, 149},
	/* idx == 83  */ {76, 6, 332, 335, 156},
	/* idx == 84  */ {80, 6, 336, 339, 165},
	/* idx == 85  */ {84, 6, 340, 343, 172},
	/* idx == 86  */ {88, 6, 344, 347, 180},
	/* idx == 87  */ {92, 6, 348, 351, 187},
	/* idx == 88  */ {96, 6, 352, 355, 197},
	/* idx == 89  */ {100, 6, 356, 359, 204},
	/* idx == 90  */ {104, 6, 360, 363, 212},
	/* idx == 91  */ {108, 6, 364, 367, 219},
	/* idx == 92  */ {112, 6, 368, 371, 228},
	/* idx == 93  */ {116, 6, 372, 375, 235},
	/* idx == 94  */ {120, 6, 376, 379, 243},
	/* idx == 95  */ {124, 6, 380, 383, 250},
	/* idx == 96  */ {128, 6, 384, 387, 262},
	/* idx == 97  */ {132, 6, 388, 391, 269},
	/* idx == 98  */ {136, 6, 392, 395, 277},
	/* idx == 99  */ {140, 6, 396, 399, 284},
	/* idx == 100 */ {144, 6, 400, 403, 293},
	/* idx == 101 */ {148, 6, 404, 407, 300},
	/* idx == 102 */ {152, 6, 408, 411, 308},
	/* idx == 103 */ {156, 6, 412, 415, 315},
	/* idx == 104 */ {160, 6, 416, 419, 325},
	/* idx == 105 */ {164, 6, 420, 423, 332},
	/* idx == 106 */ {168, 6, 424, 427, 340},
	/* idx == 107 */ {172, 6, 428, 431, 347},
	/* idx == 108 */ {176, 6, 432, 435, 356},
	/* idx == 109 */ {180, 6, 436, 439, 363},
	/* idx == 110 */ {184, 6, 440, 443, 371},
	/* idx == 111 */ {188, 6, 444, 447, 378},
	/* idx == 112 */ {192, 6, 448, 451, 389},
	/* idx == 113 */ {196, 6, 452, 455, 396},
	/* idx == 114 */ {200, 6, 456, 459, 404},
	/* idx == 115 */ {204, 6, 460, 463, 411},
	/* idx == 116 */ {208, 6, 464, 467, 420},
	/* idx == 117 */ {212, 6, 468, 471, 427},
	/* idx == 118 */ {216, 6, 472, 475, 435},
	/* idx == 119 */ {220, 6, 476, 479, 442},
	/* idx == 120 */ {224, 6, 480, 483, 452},
	/* idx == 121 */ {228, 6, 484, 487, 459},
	/* idx == 122 */ {232, 6, 488, 491, 467},
	/* idx == 123 */ {236, 6, 492, 495, 474},
	/* idx == 124 */ {240, 6, 496, 499, 483},
	/* idx == 125 */ {244, 6, 500, 503, 490},
	/* idx == 126 */ {248, 6, 504, 507, 498},
	/* idx == 127 */ {252, 6, 508, 511, 505},
	/* idx == 128 */ {0, 7, 256, 257, 8},
	/* idx == 129 */ {2, 7, 258, 259, 11},
	/* idx == 130 */ {4, 7, 260, 261, 15},
	/* idx == 131 */ {6, 7, 262, 263, 18},
	/* idx == 132 */ {8, 7, 264, 265, 23},
	/* idx == 133 */ {10, 7, 266, 267, 26},
	/* idx == 134 */ {12, 7, 268, 269, 30},
	/* idx == 135 */ {14, 7, 270, 271, 33},
	/* idx == 136 */ {16, 7, 272, 273, 39},
	/* idx == 137 */ {18, 7, 274, 275, 42},
	/* idx == 138 */ {20, 7, 276, 277, 46},
	/* idx == 139 */ {22, 7, 278, 279, 49},
	/* idx == 140 */ {24, 7, 280, 281, 54},
	/* idx == 141 */ {26, 7, 282, 283, 57},
	/* idx == 142 */ {28, 7, 284, 285, 61},
	/* idx == 143 */ {30, 7, 286, 287, 64},
	/* idx == 144 */ {32, 7, 288, 289, 71},
	/* idx == 145 */ {34, 7, 290, 291, 74},
	/* idx == 146 */ {36, 7, 292, 293, 78},
	/* idx == 147 */ {38, 7, 294, 295, 81},
	/* idx == 148 */ {40, 7, 296, 297, 86},
	/* idx == 149 */ {42, 7, 298, 299, 89},
	/* idx == 150 */ {44, 7, 300, 301, 93},
	/* idx == 151 */ {46, 7, 302, 303, 96},
	/* idx == 152 */ {48, 7, 304, 305, 102},
	/* idx == 153 */ {50, 7, 306, 307, 105},
	/* idx == 154 */ {52, 7, 308, 309, 109},
	/* idx == 155 */ {54, 7, 310, 311, 112},
	/* idx == 156 */ {56, 7, 312, 313, 117},
	/* idx == 157 */ {58, 7, 314, 315, 120},
	/* idx == 158 */ {60, 7, 316, 317, 124},
	/* idx == 159 */ {62, 7, 318, 319, 127},
	/* idx == 160 */ {64, 7, 320, 321, 135},
	/* idx == 161 */ {66, 7, 322, 323, 138},
	/* idx == 162 */ {68, 7, 324, 325, 142},
	/* idx == 163 */ {70, 7, 326, 327, 145},
	/* idx == 164 */ {72, 7, 328, 329, 150},
	/* idx == 165 */ {74, 7, 330, 331, 153},
	/* idx == 166 */ {76, 7, 332, 333, 157},
	/* idx == 167 */ {78, 7, 334, 335, 160},
	/* idx == 168 */ {80, 7, 336, 337, 166},
	/* idx == 169 */ {82, 7, 338, 339, 169},
	/* idx == 170 */ {84, 7, 340, 341, 173},
	/* idx == 171 */ {86, 7, 342, 343, 176},
	/* idx == 172 */ {88, 7, 344, 345, 181},
	/* idx == 173 */ {90, 7, 346, 347, 184},
	/* idx == 174 */ {92, 7, 348, 349, 188},
	/* idx == 175 */ {94, 7, 350, 351, 191},
	/* idx == 176 */ {96, 7, 352, 353, 198},
	/* idx == 177 */ {98, 7, 354, 355, 201},
	/* idx == 178 */ {100, 7, 356, 357, 205},
	/* idx == 179 */ {102, 7, 358, 359, 208},
	/* idx == 180 */ {104, 7, 360, 361, 213},
	/* idx == 181 */ {106, 7, 362, 363, 216},
	/* idx == 182 */ {108, 7, 364, 365, 220},
	/* idx == 183 */ {110, 7, 366, 367, 223},
	/* idx == 184 */ {112, 7, 368, 369, 229},
	/* idx == 185 */ {114, 7, 370, 371, 232},
	/* idx == 186 */ {116, 7, 372, 373, 236},
	/* idx == 187 */ {118, 7, 374, 375, 239},
	/* idx == 188 */ {120, 7, 376, 377, 244},
	/* idx == 189 */ {122, 7, 378, 379, 247},
	/* idx == 190 */ {124, 7, 380, 381, 251},
	/* idx == 191 */ {126, 7, 382, 383, 254},
	/* idx == 192 */ {128, 7, 384, 385, 263},
	/* idx == 193 */ {130, 7, 386, 387, 266},
	/* idx == 194 */ {132, 7, 388, 389, 270},
	/* idx == 195 */ {134, 7, 390, 391, 273},
	/* idx == 196 */ {136, 7, 392, 393, 278},
	/* idx == 197 */ {138, 7, 394, 395, 281},
	/* idx == 198 */ {140, 7, 396, 397, 285},
	/* idx == 199 */ {142, 7, 398, 399, 288},
	/* idx == 200 */ {144, 7, 400, 401, 294},
	/* idx == 201 */ {146, 7, 402, 403, 297},
	/* idx == 202 */ {148, 7, 404, 405, 301},
	/* idx == 203 */ {150, 7, 406, 407, 304},
	/* idx == 204 */ {152, 7, 408, 409, 309},
	/* idx == 205 */ {154, 7, 410, 411, 312},
	/* idx == 206 */ {156, 7, 412, 413, 316},
	/* idx == 207 */ {158, 7, 414, 415, 319},
	/* idx == 208 */ {160, 7, 416, 417, 326},
	/* idx == 209 */ {162, 7, 418, 419, 329},
	/* idx == 210 */ {164, 7, 420, 421, 333},
	/* idx == 211 */ {166, 7, 422, 423, 336},
	/* idx == 212 */ {168, 7, 424, 425, 341},
	/* idx == 213 */ {170, 7, 426, 427, 344},
	/* idx == 214 */ {172, 7, 428, 429, 348},
	/* idx == 215 */ {174, 7, 430, 431, 351},
	/* idx == 216 */ {176, 7, 432, 433, 357},
	/* idx == 217 */ {178, 7, 434, 435, 360},
	/* idx == 218 */ {180, 7, 436, 437, 364},
	/* idx == 219 */ {182, 7, 438, 439, 367},
	/* idx == 220 */ {184, 7, 440, 441, 372},
	/* idx == 221 */ {186, 7, 442, 443, 375},
	/* idx == 222 */ {188, 7, 444, 445, 379},
	/* idx == 223 */ {190, 7, 446, 447, 382},
	/* idx == 224 */ {192, 7, 448, 449, 390},
	/* idx == 225 */ {194, 7, 450, 451, 393},
	/* idx == 226 */ {196, 7, 452, 453, 397},
	/* idx == 227 */ {198, 7, 454, 455, 400},
	/* idx == 228 */ {200, 7, 456, 457, 405},
	/* idx == 229 */ {202, 7, 458, 459, 408},
	/* idx == 230 */ {204, 7, 460, 461, 412},
	/* idx == 231 */ {206, 7, 462, 463, 415},
	/* idx == 232 */ {208, 7, 464, 465, 421},
	/* idx == 233 */ {210, 7, 466, 467, 424},
	/* idx == 234 */ {212, 7, 468, 469, 428},
	/* idx == 235 */ {214, 7, 470, 471, 431},
	/* idx == 236 */ {216, 7, 472, 473, 436},
	/* idx == 237 */ {218, 7, 474, 475, 439},
	/* idx == 238 */ {220, 7, 476, 477, 443},
	/* idx == 239 */ {222, 7, 478, 479, 446},
	/* idx == 240 */ {224, 7, 480, 481, 453},
	/* idx == 241 */ {226, 7, 482, 483, 456},
	/* idx == 242 */ {228, 7, 484, 485, 460},
	/* idx == 243 */ {230, 7, 486, 487, 463},
	/* idx == 244 */ {232, 7, 488, 489, 468},
	/* idx == 245 */ {234, 7, 490, 491, 471},
	/* idx == 246 */ {236, 7, 492, 493, 475},
	/* idx == 247 */ {238, 7, 494, 495, 478},
	/* idx == 248 */ {240, 7, 496, 497, 484},
	/* idx == 249 */ {242, 7, 498, 499, 487},
	/* idx == 250 */ {244, 7, 500, 501, 491},
	/* idx == 251 */ {246, 7, 502, 503, 494},
	/* idx == 252 */ {248, 7, 504, 505, 499},
	/* idx == 253 */ {250, 7, 506, 507, 502},
	/* idx == 254 */ {252, 7, 508, 509, 506},
	/* idx == 255 */ {254, 7, 510, 511, 509},
	//
	// START of HOST ROUTES, pfxLen == 8
	//
	/* idx == 256 */ {0, 8, 256, 256, 9},
	/* idx == 257 */ {1, 8, 257, 257, 10},
	/* idx == 258 */ {2, 8, 258, 258, 12},
	/* idx == 259 */ {3, 8, 259, 259, 13},
	/* idx == 260 */ {4, 8, 260, 260, 16},
	/* idx == 261 */ {5, 8, 261, 261, 17},
	/* idx == 262 */ {6, 8, 262, 262, 19},
	/* idx == 263 */ {7, 8, 263, 263, 20},
	/* idx == 264 */ {8, 8, 264, 264, 24},
	/* idx == 265 */ {9, 8, 265, 265, 25},
	/* idx == 266 */ {10, 8, 266, 266, 27},
	/* idx == 267 */ {11, 8, 267, 267, 28},
	/* idx == 268 */ {12, 8, 268, 268, 31},
	/* idx == 269 */ {13, 8, 269, 269, 32},
	/* idx == 270 */ {14, 8, 270, 270, 34},
	/* idx == 271 */ {15, 8, 271, 271, 35},
	/* idx == 272 */ {16, 8, 272, 272, 40},
	/* idx == 273 */ {17, 8, 273, 273, 41},
	/* idx == 274 */ {18, 8, 274, 274, 43},
	/* idx == 275 */ {19, 8, 275, 275, 44},
	/* idx == 276 */ {20, 8, 276, 276, 47},
	/* idx == 277 */ {21, 8, 277, 277, 48},
	/* idx == 278 */ {22, 8, 278, 278, 50},
	/* idx == 279 */ {23, 8, 279, 279, 51},
	/* idx == 280 */ {24, 8, 280, 280, 55},
	/* idx == 281 */ {25, 8, 281, 281, 56},
	/* idx == 282 */ {26, 8, 282, 282, 58},
	/* idx == 283 */ {27, 8, 283, 283, 59},
	/* idx == 284 */ {28, 8, 284, 284, 62},
	/* idx == 285 */ {29, 8, 285, 285, 63},
	/* idx == 286 */ {30, 8, 286, 286, 65},
	/* idx == 287 */ {31, 8, 287, 287, 66},
	/* idx == 288 */ {32, 8, 288, 288, 72},
	/* idx == 289 */ {33, 8, 289, 289, 73},
	/* idx == 290 */ {34, 8, 290, 290, 75},
	/* idx == 291 */ {35, 8, 291, 291, 76},
	/* idx == 292 */ {36, 8, 292, 292, 79},
	/* idx == 293 */ {37, 8, 293, 293, 80},
	/* idx == 294 */ {38, 8, 294, 294, 82},
	/* idx == 295 */ {39, 8, 295, 295, 83},
	/* idx == 296 */ {40, 8, 296, 296, 87},
	/* idx == 297 */ {41, 8, 297, 297, 88},
	/* idx == 298 */ {42, 8, 298, 298, 90},
	/* idx == 299 */ {43, 8, 299, 299, 91},
	/* idx == 300 */ {44, 8, 300, 300, 94},
	/* idx == 301 */ {45, 8, 301, 301, 95},
	/* idx == 302 */ {46, 8, 302, 302, 97},
	/* idx == 303 */ {47, 8, 303, 303, 98},
	/* idx == 304 */ {48, 8, 304, 304, 103},
	/* idx == 305 */ {49, 8, 305, 305, 104},
	/* idx == 306 */ {50, 8, 306, 306, 106},
	/* idx == 307 */ {51, 8, 307, 307, 107},
	/* idx == 308 */ {52, 8, 308, 308, 110},
	/* idx == 309 */ {53, 8, 309, 309, 111},
	/* idx == 310 */ {54, 8, 310, 310, 113},
	/* idx == 311 */ {55, 8, 311, 311, 114},
	/* idx == 312 */ {56, 8, 312, 312, 118},
	/* idx == 313 */ {57, 8, 313, 313, 119},
	/* idx == 314 */ {58, 8, 314, 314, 121},
	/* idx == 315 */ {59, 8, 315, 315, 122},
	/* idx == 316 */ {60, 8, 316, 316, 125},
	/* idx == 317 */ {61, 8, 317, 317, 126},
	/* idx == 318 */ {62, 8, 318, 318, 128},
	/* idx == 319 */ {63, 8, 319, 319, 129},
	/* idx == 320 */ {64, 8, 320, 320, 136},
	/* idx == 321 */ {65, 8, 321, 321, 137},
	/* idx == 322 */ {66, 8, 322, 322, 139},
	/* idx == 323 */ {67, 8, 323, 323, 140},
	/* idx == 324 */ {68, 8, 324, 324, 143},
	/* idx == 325 */ {69, 8, 325, 325, 144},
	/* idx == 326 */ {70, 8, 326, 326, 146},
	/* idx == 327 */ {71, 8, 327, 327, 147},
	/* idx == 328 */ {72, 8, 328, 328, 151},
	/* idx == 329 */ {73, 8, 329, 329, 152},
	/* idx == 330 */ {74, 8, 330, 330, 154},
	/* idx == 331 */ {75, 8, 331, 331, 155},
	/* idx == 332 */ {76, 8, 332, 332, 158},
	/* idx == 333 */ {77, 8, 333, 333, 159},
	/* idx == 334 */ {78, 8, 334, 334, 161},
	/* idx == 335 */ {79, 8, 335, 335, 162},
	/* idx == 336 */ {80, 8, 336, 336, 167},
	/* idx == 337 */ {81, 8, 337, 337, 168},
	/* idx == 338 */ {82, 8, 338, 338, 170},
	/* idx == 339 */ {83, 8, 339, 339, 171},
	/* idx == 340 */ {84, 8, 340, 340, 174},
	/* idx == 341 */ {85, 8, 341, 341, 175},
	/* idx == 342 */ {86, 8, 342, 342, 177},
	/* idx == 343 */ {87, 8, 343, 343, 178},
	/* idx == 344 */ {88, 8, 344, 344, 182},
	/* idx == 345 */ {89, 8, 345, 345, 183},
	/* idx == 346 */ {90, 8, 346, 346, 185},
	/* idx == 347 */ {91, 8, 347, 347, 186},
	/* idx == 348 */ {92, 8, 348, 348, 189},
	/* idx == 349 */ {93, 8, 349, 349, 190},
	/* idx == 350 */ {94, 8, 350, 350, 192},
	/* idx == 351 */ {95, 8, 351, 351, 193},
	/* idx == 352 */ {96, 8, 352, 352, 199},
	/* idx == 353 */ {97, 8, 353, 353, 200},
	/* idx == 354 */ {98, 8, 354, 354, 202},
	/* idx == 355 */ {99, 8, 355, 355, 203},
	/* idx == 356 */ {100, 8, 356, 356, 206},
	/* idx == 357 */ {101, 8, 357, 357, 207},
	/* idx == 358 */ {102, 8, 358, 358, 209},
	/* idx == 359 */ {103, 8, 359, 359, 210},
	/* idx == 360 */ {104, 8, 360, 360, 214},
	/* idx == 361 */ {105, 8, 361, 361, 215},
	/* idx == 362 */ {106, 8, 362, 362, 217},
	/* idx == 363 */ {107, 8, 363, 363, 218},
	/* idx == 364 */ {108, 8, 364, 364, 221},
	/* idx == 365 */ {109, 8, 365, 365, 222},
	/* idx == 366 */ {110, 8, 366, 366, 224},
	/* idx == 367 */ {111, 8, 367, 367, 225},
	/* idx == 368 */ {112, 8, 368, 368, 230},
	/* idx == 369 */ {113, 8, 369, 369, 231},
	/* idx == 370 */ {114, 8, 370, 370, 233},
	/* idx == 371 */ {115, 8, 371, 371, 234},
	/* idx == 372 */ {116, 8, 372, 372, 237},
	/* idx == 373 */ {117, 8, 373, 373, 238},
	/* idx == 374 */ {118, 8, 374, 374, 240},
	/* idx == 375 */ {119, 8, 375, 375, 241},
	/* idx == 376 */ {120, 8, 376, 376, 245},
	/* idx == 377 */ {121, 8, 377, 377, 246},
	/* idx == 378 */ {122, 8, 378, 378, 248},
	/* idx == 379 */ {123, 8, 379, 379, 249},
	/* idx == 380 */ {124, 8, 380, 380, 252},
	/* idx == 381 */ {125, 8, 381, 381, 253},
	/* idx == 382 */ {126, 8, 382, 382, 255},
	/* idx == 383 */ {127, 8, 383, 383, 256},
	/* idx == 384 */ {128, 8, 384, 384, 264},
	/* idx == 385 */ {129, 8, 385, 385, 265},
	/* idx == 386 */ {130, 8, 386, 386, 267},
	/* idx == 387 */ {131, 8, 387, 387, 268},
	/* idx == 388 */ {132, 8, 388, 388, 271},
	/* idx == 389 */ {133, 8, 389, 389, 272},
	/* idx == 390 */ {134, 8, 390, 390, 274},
	/* idx == 391 */ {135, 8, 391, 391, 275},
	/* idx == 392 */ {136, 8, 392, 392, 279},
	/* idx == 393 */ {137, 8, 393, 393, 280},
	/* idx == 394 */ {138, 8, 394, 394, 282},
	/* idx == 395 */ {139, 8, 395, 395, 283},
	/* idx == 396 */ {140, 8, 396, 396, 286},
	/* idx == 397 */ {141, 8, 397, 397, 287},
	/* idx == 398 */ {142, 8, 398, 398, 289},
	/* idx == 399 */ {143, 8, 399, 399, 290},
	/* idx == 400 */ {144, 8, 400, 400, 295},
	/* idx == 401 */ {145, 8, 401, 401, 296},
	/* idx == 402 */ {146, 8, 402, 402, 298},
	/* idx == 403 */ {147, 8, 403, 403, 299},
	/* idx == 404 */ {148, 8, 404, 404, 302},
	/* idx == 405 */ {149, 8, 405, 405, 303},
	/* idx == 406 */ {150, 8, 406, 406, 305},
	/* idx == 407 */ {151, 8, 407, 407, 306},
	/* idx == 408 */ {152, 8, 408, 408, 310},
	/* idx == 409 */ {153, 8, 409, 409, 311},
	/* idx == 410 */ {154, 8, 410, 410, 313},
	/* idx == 411 */ {155, 8, 411, 411, 314},
	/* idx == 412 */ {156, 8, 412, 412, 317},
	/* idx == 413 */ {157, 8, 413, 413, 318},
	/* idx == 414 */ {158, 8, 414, 414, 320},
	/* idx == 415 */ {159, 8, 415, 415, 321},
	/* idx == 416 */ {160, 8, 416, 416, 327},
	/* idx == 417 */ {161, 8, 417, 417, 328},
	/* idx == 418 */ {162, 8, 418, 418, 330},
	/* idx == 419 */ {163, 8, 419, 419, 331},
	/* idx == 420 */ {164, 8, 420, 420, 334},
	/* idx == 421 */ {165, 8, 421, 421, 335},
	/* idx == 422 */ {166, 8, 422, 422, 337},
	/* idx == 423 */ {167, 8, 423, 423, 338},
	/* idx == 424 */ {168, 8, 424, 424, 342},
	/* idx == 425 */ {169, 8, 425, 425, 343},
	/* idx == 426 */ {170, 8, 426, 426, 345},
	/* idx == 427 */ {171, 8, 427, 427, 346},
	/* idx == 428 */ {172, 8, 428, 428, 349},
	/* idx == 429 */ {173, 8, 429, 429, 350},
	/* idx == 430 */ {174, 8, 430, 430, 352},
	/* idx == 431 */ {175, 8, 431, 431, 353},
	/* idx == 432 */ {176, 8, 432, 432, 358},
	/* idx == 433 */ {177, 8, 433, 433, 359},
	/* idx == 434 */ {178, 8, 434, 434, 361},
	/* idx == 435 */ {179, 8, 435, 435, 362},
	/* idx == 436 */ {180, 8, 436, 436, 365},
	/* idx == 437 */ {181, 8, 437, 437, 366},
	/* idx == 438 */ {182, 8, 438, 438, 368},
	/* idx == 439 */ {183, 8, 439, 439, 369},
	/* idx == 440 */ {184, 8, 440, 440, 373},
	/* idx == 441 */ {185, 8, 441, 441, 374},
	/* idx == 442 */ {186, 8, 442, 442, 376},
	/* idx == 443 */ {187, 8, 443, 443, 377},
	/* idx == 444 */ {188, 8, 444, 444, 380},
	/* idx == 445 */ {189, 8, 445, 445, 381},
	/* idx == 446 */ {190, 8, 446, 446, 383},
	/* idx == 447 */ {191, 8, 447, 447, 384},
	/* idx == 448 */ {192, 8, 448, 448, 391},
	/* idx == 449 */ {193, 8, 449, 449, 392},
	/* idx == 450 */ {194, 8, 450, 450, 394},
	/* idx == 451 */ {195, 8, 451, 451, 395},
	/* idx == 452 */ {196, 8, 452, 452, 398},
	/* idx == 453 */ {197, 8, 453, 453, 399},
	/* idx == 454 */ {198, 8, 454, 454, 401},
	/* idx == 455 */ {199, 8, 455, 455, 402},
	/* idx == 456 */ {200, 8, 456, 456, 406},
	/* idx == 457 */ {201, 8, 457, 457, 407},
	/* idx == 458 */ {202, 8, 458, 458, 409},
	/* idx == 459 */ {203, 8, 459, 459, 410},
	/* idx == 460 */ {204, 8, 460, 460, 413},
	/* idx == 461 */ {205, 8, 461, 461, 414},
	/* idx == 462 */ {206, 8, 462, 462, 416},
	/* idx == 463 */ {207, 8, 463, 463, 417},
	/* idx == 464 */ {208, 8, 464, 464, 422},
	/* idx == 465 */ {209, 8, 465, 465, 423},
	/* idx == 466 */ {210, 8, 466, 466, 425},
	/* idx == 467 */ {211, 8, 467, 467, 426},
	/* idx == 468 */ {212, 8, 468, 468, 429},
	/* idx == 469 */ {213, 8, 469, 469, 430},
	/* idx == 470 */ {214, 8, 470, 470, 432},
	/* idx == 471 */ {215, 8, 471, 471, 433},
	/* idx == 472 */ {216, 8, 472, 472, 437},
	/* idx == 473 */ {217, 8, 473, 473, 438},
	/* idx == 474 */ {218, 8, 474, 474, 440},
	/* idx == 475 */ {219, 8, 475, 475, 441},
	/* idx == 476 */ {220, 8, 476, 476, 444},
	/* idx == 477 */ {221, 8, 477, 477, 445},
	/* idx == 478 */ {222, 8, 478, 478, 447},
	/* idx == 479 */ {223, 8, 479, 479, 448},
	/* idx == 480 */ {224, 8, 480, 480, 454},
	/* idx == 481 */ {225, 8, 481, 481, 455},
	/* idx == 482 */ {226, 8, 482, 482, 457},
	/* idx == 483 */ {227, 8, 483, 483, 458},
	/* idx == 484 */ {228, 8, 484, 484, 461},
	/* idx == 485 */ {229, 8, 485, 485, 462},
	/* idx == 486 */ {230, 8, 486, 486, 464},
	/* idx == 487 */ {231, 8, 487, 487, 465},
	/* idx == 488 */ {232, 8, 488, 488, 469},
	/* idx == 489 */ {233, 8, 489, 489, 470},
	/* idx == 490 */ {234, 8, 490, 490, 472},
	/* idx == 491 */ {235, 8, 491, 491, 473},
	/* idx == 492 */ {236, 8, 492, 492, 476},
	/* idx == 493 */ {237, 8, 493, 493, 477},
	/* idx == 494 */ {238, 8, 494, 494, 479},
	/* idx == 495 */ {239, 8, 495, 495, 480},
	/* idx == 496 */ {240, 8, 496, 496, 485},
	/* idx == 497 */ {241, 8, 497, 497, 486},
	/* idx == 498 */ {242, 8, 498, 498, 488},
	/* idx == 499 */ {243, 8, 499, 499, 489},
	/* idx == 500 */ {244, 8, 500, 500, 492},
	/* idx == 501 */ {245, 8, 501, 501, 493},
	/* idx == 502 */ {246, 8, 502, 502, 495},
	/* idx == 503 */ {247, 8, 503, 503, 496},
	/* idx == 504 */ {248, 8, 504, 504, 500},
	/* idx == 505 */ {249, 8, 505, 505, 501},
	/* idx == 506 */ {250, 8, 506, 506, 503},
	/* idx == 507 */ {251, 8, 507, 507, 504},
	/* idx == 508 */ {252, 8, 508, 508, 507},
	/* idx == 509 */ {253, 8, 509, 509, 508},
	/* idx == 510 */ {254, 8, 510, 510, 510},
	/* idx == 511 */ {255, 8, 511, 511, 511},
}
